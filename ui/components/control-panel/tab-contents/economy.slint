import { ListView } from "std-widgets.slint";
import { MacroEconData, UpDown, ProductDemand } from "../../../state.slint";
import { Palette } from "../../../theme.slint";
import { Globs } from "../../../globals.slint";

import { TabContent } from "./tab-content.slint";
import { DataTable } from "../../common/datatable.slint";
import { CellData } from "../../common/datacell.slint";
import { PanelTitle } from "../../common/panel-title.slint";

component DemandItem {
	in property <ProductDemand> pd;

	Rectangle {
		height: 50px;
		background: Palette.bg_lightgray;
		VerticalLayout {
			padding: 8px;
			txt := Text {
				text: pd.product_name + " demand " + pd.percent + "%, since " + pd.age + " hours and " + pd.demand_met + "% is met.";
				font-size: 10px;
				horizontal-alignment: left;
				wrap: word-wrap;
				font-weight: 700;
			}
		}
	}
}

export component EconomyTab inherits TabContent {
	in property <MacroEconData> macroecon: Globs.macroecon;

	VerticalLayout {
		height: 100%;
		VerticalLayout {
			height: 8%;
			DataTable {
				title: "Macroeconomics";
				items: [
					{
						label: "Inflation rate",
						value: macroecon.inflation-rate,
						value_postfix: " %",
					},
					{
						label: "Inflation direction",
						value: macroecon.inflation-direction == UpDown.Up ? "Up" : "Down",
					},
					{
						label: "Fuel price",
						value: macroecon.fuel-price,
						value_postfix: " ÏŸ",
					},
				];
			}
		}
		VerticalLayout {
			height: 90%;
			PanelTitle {
				txt: "Product Demands";
			}

			ListView {
				height: 100%;
				for pd in Globs.product_demands: DemandItem {
					pd: pd;
				}
			}
		}
	}
}